{% extends 'base.html.twig' %} 
{% block stylesheets %}
    <link rel="stylesheet" href="{{ asset('assets/css/bootstrap.min.css') }}">
    <link rel="stylesheet" href="{{ asset('assets/css/jquery-ui.min.css') }}">
    <link rel="stylesheet" href="{{ asset('assets/css/main.css') }}">
    <link rel="stylesheet" href="{{ asset('assets/css/search.css') }}">
{% endblock %} 
{% block title %}{{ short_title }} | Search{% endblock %}
{% block content %}
<header>
	<nav class="navbar navbar-default">
		<div class="container-fluid">
			<div class="navbar-header tor_ibin_header">
				<img alt="" src="{{ asset('assets/images/tor_ibin_logo.png') }}" class="logo left">
				<h5 class="nav-header" style="color: {{ color_scheme }}">{{ short_title }}</h5>
				<button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#myNavbar">
					<span class="icon-bar"></span>
					<span class="icon-bar"></span> 
					<span class="icon-bar"></span>
				</button>
			</div>
			<div id="myNavbar" class="collapse navbar-collapse">
				<ul class="nav navbar-nav ">
					<li><a href="{{ path('home') }}">Home</a></li>
					<li class="active"><a href="{{ path('search') }}">Search</a></li>
					<li><a href="{{ path('search') }}">Downloads</a></li>
		      		<li><a href="{{ path('about') }}">About</a></li>
				</ul>
				<ul class="nav navbar-nav navbar-right">
    			   <li><a href="{{ path('fos_user_security_login') }}">Login</a></li>
    		    </ul>
			</div>
		</div>
		<div class="shadow"></div>
	</nav>
</header>
<main>
    <div class="row" style="background-color: #EEEEEE;">
    	<div class="search_outer_panel"
    		style="background-color: {{ color_scheme }}">
    		<div class="search_inner_panel">
    			<div class="row search_header">
    				<h4 style="color: #FFFFFF">
    					<strong>Search {{ short_title }}</strong>
    				</h4>
    			</div>
    			<div class="row search_content  search_panel"
    				style="background-color: #FFFFFF">
    				<div class="col-sm-12">
    					{{ form_start(form) }}
    					<div class="row" style='width: 84%; margin: 20px;'>
    						<h4 class="left">Identifier:</h4>
    						<a href='#' class='string_example example_small right'
    							onclick='
    										$("#form_identifier").val("Q5JRA6-2");
    										$("#form_organism_select").val("9606").trigger("change");
    									'>#3</a> <a href='#' class='string_example example_small right'
    							onclick='
    										$("#form_identifier").val("Q5JS98");
    										$("#form_organism_select").val("9606").trigger("change");
    									'>#2</a> <a href='#' class='string_example example_small right'
    							onclick='
    										$("#form_identifier").val("Q5SQN1");
    										$("#form_organism_select").val("9606").trigger("change");
    									'>#1</a>
    
    						<p class="right">Examples:</p>
    					</div>
    					<div class="row" style='margin: 20px;'>
    						<div class="input-group input-group-sm">
    							{{ form_widget(form.identifier) }} <span class="input-group-btn">
    								<button type="submit" class="btn btn-success" type="button" id="search_btn">Search</button>
    							</span>
    						</div>
    					</div>
    					<div class="row">
    						<div class="col-sm-4">
    							<div class="row" style='margin: 20px;'>
    								<h4>{{ form_label(form.organism_select) }}</h4>
    							</div>
    							<div class="row" style='margin: 20px;'>
    								<div class="input-group input-group-sm">{{ form_widget(form.organism_select) }}</div>
    							</div>
    						</div>
    						<div class="col-sm-5">
    							<div class="row" style='margin: 20px;'>
    								<h4>{{ form_label(form.max_number_of_interactions) }}</h4>
    							</div>
    							<div class="row" style='margin: 20px;'>
    								<div class="input-group input-group-sm">{{ form_widget(form.max_number_of_interactions) }}</div>
    							</div>
    						</div>
    					</div>
    					<div class="row">
    						<div class="col-sm-4">
    							<div class="row" style='margin: 20px;'>
    								<h4>{{ form_label(form.domain_select) }}:</h4>
    							</div>
    							<div id="test"></div>
    							<div class="row" style='margin: 20px;'>
    								<div class="input-group input-group-sm">{{ form_widget(form.domain_select) }}</div>
    							</div>
    						</div>
    						<div class="col-sm-5">
        						<div class="row" style='margin: 20px;'>
        							<h4>{{ form_label(form.min_interaction_score) }}</h4>
        						</div>
        						<div class="row" style='margin: 20px;'>
        							<div class="input-group input-group-sm">
        								<div id="min_interaction_score">
        									<div id="min_interaction_score_handle" class="ui-slider-handle"></div>
        								</div>
        								{{ form_widget(form.min_interaction_score) }}
        							</div>
        						</div>
        					</div>
    					</div>
    				</div>
    				{{ form_end(form) }}
    			</div>
    		</div>
    	</div>
    </div>
    <div class="shadow"></div>
</main>
{% endblock %} 
{% block javascripts %}
    <script src="{{ asset('bundles/fosjsrouting/js/router.js') }}"></script>
    <script src="{{ path('fos_js_routing_js', { callback: 'fos.Router.setData' }) }}"></script>
    <script src="{{ asset('assets/js/jquery-2.1.4.min.js') }}"></script>
    <script src="{{ asset('assets/js/jquery-ui.min.js') }}"></script>
    <script src="{{ asset('assets/js/bootstrap.min.js') }}"></script>
    <script src="{{ asset('assets/js/main.js') }}"></script>
    <script src="{{ asset('assets/js/search.js') }}"></script>
    <script>
        $(function() {
        	
            $( "#min_interaction_score" ).slider({
        
        		step: 0.01,
                min: 0,
                max: 1,
                value: 0,
                change:function( event, ui ) {
                  $("#form_min_interaction_score").val(ui.value);
                },
                slide: function( event, ui ) {
                  $("#min_interaction_score_handle").html(ui.value);
                }
              });
            
            $("#min_interaction_score_handle").html($( "#min_interaction_score" ).slider( "value" ));
        
        	
        	$("#form_identifier").autocomplete({
        		source: function(request, response){
        
        			url = 'http://localhost/php_eclipse_workspace/tor_ibin/web/app.php/admin/search/autocomplete/' + request.term;
        			
        
        			$.getJSON(url, function(data){
        				response(data);
        			});
        		},
        		minLength: 2,
        	});
        	
        	$("#form_organism_select").on( "change", function() {
        
        		var searchTerm = $("#form_organism_select").val();
        		var targetUrl = Routing.generate('organmism_domain', { search_term: searchTerm });
        	    $.ajax({url: targetUrl, success: function(results){
        	    	var results_array = $.parseJSON(results);
        	    	$('.domain_option').remove();
        	    	for (i=0;i<results_array.length;i++){
        
        	    		var domainOption = '<option class="domain_option" value="' + results_array[i] + '">' + results_array[i] + '</option>';
        
        	    		
        	    		$('#form_domain_select').append(domainOption);
        	    		$('#form_domain_select').on('change', function () {
                            if ($( "select[id$=_role] option:selected").val() === 'new') {
                                    $('#new_role').modal('show');
                            }
                    	});
        		    }
        
        	    	
        	    }});
        	});
        	
        });
    
    </script>
{% endblock %}
